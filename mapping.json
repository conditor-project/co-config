{
  "settings":{
    "index": {
      "number_of_replicas": 0,
      "query": {
        "default_field":[
          "_id",
          "abstract",
          "articleNumber",
          "articleNumber.normalized",
          "arxiv",
          "arxiv.normalized",
          "first3AuthorNames",
          "first3AuthorNames.normalized",
          "authorNames",
          "first3AuthorNamesWithInitials",
          "first3AuthorNamesWithInitials.normalized",
          "bibCode",
          "bibCode.normalized",
          "cern",
          "cern.normalized",
          "doi",
          "doi.normalized",
          "duplicate.idConditor",
          "duplicate.sessionName",
          "duplicate.rules",
          "duplicate.source",
          "duplicateRules",
          "eisbn",
          "eisbn.normalized",
          "eissn",
          "eissn.normalized",
          "ensam",
          "ensam.normalized",
          "halAuthorId",
          "idChain",
          "idConditor",
          "idHal",
          "idHal.normalized",
          "idProdinra",
          "idProdinra.normalized",
          "ineris",
          "ineris.normalized",
          "ingestBaseName",
          "sessionName",
          "inspire",
          "inspire.normalized",
          "ird",
          "ird.normalized",
          "irstea",
          "irstea.normalized",
          "isbn",
          "isbn.normalized",
          "isni",
          "isni.normalized",
          "issn",
          "issn.normalized",
          "issue",
          "localRef",
          "localRef.normalized",
          "meetAbstrNo",
          "meetAbstrNo.normalized",
          "meetingTitle",
          "meetingTitle.normalized",
          "nnt",
          "nnt.normalized",
          "oatao",
          "oatao.normalized",
          "okina",
          "okina.normalized",
          "orcId",
          "orcId.normalized",
          "otherNumber",
          "otherNumber.normalized",
          "pageRange",
          "part",
          "supplement",
          "patentNumber",
          "patentNumber.normalized",
          "pmId",
          "pmId.normalized",
          "ppn",
          "ppn.normalized",
          "publicationDate",
          "publicationDate.normalized",
          "pmc",
          "pmc.normalized",
          "reportNumber",
          "reportNumber.normalized",
          "researcherId",
          "sciencespo",
          "sciencespo.normalized",
          "source",
          "specialIssue",
          "title",
          "title.normalized",
          "title.normalized50",
          "titleen",
          "titleen.normalized",
          "titleen.normalized50",
          "titlefr",
          "titlefr.normalized",
          "titlefr.normalized50",
          "titreSourceJ",
          "titreSourceJ.normalized",
          "titreSourceM",
          "titreSourceM.normalized",
          "typeConditor",
          "typeConditor.normalized",
          "typeDocument",
          "ut",
          "ut.normalized",
          "viaf",
          "volume",
          "xissn"
        ]
      }
    },
    "similarity":{
      "bm25_similarity":{
        "type" : "BM25",
        "b" : 0.75,
        "k1":1.2
      }
    },
    "analysis":{
      "char_filter":{
        "whitespace_remove": {
          "type": "pattern_replace",
          "pattern": "\\s+",
          "replacement": ""
        },
        "punctuation_remove": {
          "type": "pattern_replace",
          "pattern": "\\p{P}",
          "replacement": ""
        },
        "spacenum":{
          "type": "pattern_replace",
          "pattern": "[^0-9]",
          "replacement":"_"
        },
        "num":{
          "type": "pattern_replace",
          "pattern": "[^0-9]",
          "replacement":""
        },
        "annee":{
          "type": "pattern_replace",
          "pattern": ".*([0-9]{4}).*",
          "replacement":"$1"
        },
        "alphanum":{
          "type": "pattern_replace",
          "pattern": "[^0-9a-zA-Z]",
          "replacement":""
        },
        "firstnum":{
          "type": "pattern_replace",
          "pattern": "^[_]*([0-9]+)[_]*.*",
          "replacement":"$1"
        },
        "remove_underscore":{
          "type":"pattern_replace",
          "pattern":"[_]",
          "replacement":""
        },
        "trunc_50":{
          "type":"pattern_replace",
          "pattern":"([0-9a-zA-Z]{50}).*",
          "replacement":"$1"
        },
        "trunc_75":{
          "type":"pattern_replace",
          "pattern":"([0-9a-zA-Z]{75}).*",
          "replacement":"$1"
        }
      },
      "filter":{
        "my_asciifolding":{
          "type":"asciifolding",
          "preserve_original" : false
        },
        "truncate50":{
          "type":"truncate",
          "length":50
        },
        "truncate75":{
          "type":"truncate",
          "length":75
        },
        "filter_shingles":{
          "type":"shingle",
          "max_shingle_size":4,
          "min_shingle_size":2,
          "output_unigrams":"true"
        },
        "filter_french_word":{
          "type":"stop",
          "stopwords":"_french_"
        }
      },
      "analyzer":{
        "analyzer:trunc50":{
          "type":"custom",
          "tokenizer":"keyword",
          "char_filter":["whitespace_remove","punctuation_remove"],
          "filter":["lowercase","my_asciifolding","icu_normalizer","truncate50"]
        },
        "analyzer:shingles":{
          "type":"custom",
          "tokenizer":"standard",
          "filter":["lowercase","my_asciifolding","icu_normalizer","filter_french_word","filter_shingles"]
        }
      },
      "normalizer":{
        "title:normalizer":{
          "type": "custom",
          "char_filter":["whitespace_remove","punctuation_remove"],
          "filter":["lowercase","my_asciifolding","icu_normalizer"]
        },
        "titre50:normalizer":{
          "type":"custom",
          "char_filter":["whitespace_remove","punctuation_remove","trunc_50"],
          "filter":["lowercase","my_asciifolding","icu_normalizer"]
        },
        "author:normalizer":{
          "type":"custom",
          "char_filter":["whitespace_remove","punctuation_remove"],
          "filter":["lowercase","my_asciifolding","icu_normalizer"]
        },
        "id:normalizer":{
          "type":"custom",
          "char_filter":["alphanum"],
          "filter":["lowercase"]
        },
        "volpage:normalizer":{
          "type":"custom",
          "char_filter":["spacenum","firstnum","remove_underscore"]
        },
        "issue:normalizer":{
          "type":"custom",
          "char_filter":["num"]
        },
        "publicationDate:normalizer":{
          "type":"custom",
          "char_filter":["annee"]
        }
      }
    }
  },
  "mappings":{
    "record": {
      "dynamic": "false",
      "properties": {
        "fingerprint":{
          "type":"text",
          "analyzer":"analyzer:shingles"
        },
        "idConditor":{
          "type":"keyword"
        },
        "sessionName":{
          "type":"keyword"
        },
        "ingestBaseName":{
          "type":"keyword"
        },
        "path":{
          "type":"text",
          "index":false
        },
        "teiBlob":{
          "type":"binary"
        },
        "first3AuthorNames": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"author:normalizer"
              }
            },
          "copy_to":"fingerprint"
        },
        "first3AuthorNamesWithInitials": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"author:normalizer"
            }
          }
        },
        "authorNames":{
          "type":"text"
        },
        "authors":{
          "type":"nested",
          "properties": {
            "surname":{
              "type":"keyword"
            },
            "forename":{
              "type":"keyword"
            },
            "halAuthorId":{
              "type":"keyword"
            },
            "researcherId":{
              "type":"keyword"
            },
            "affiliations":{
              "type":"nested",
              "properties": {
                "ref":{
                  "type":"keyword"
                },
                "address":{
                  "type": "keyword"
                }
              }
            },
            "idRef":{
              "type":"keyword"
            },
            "isni": {
              "type":"keyword"
            },
            "orcid": {
              "type":"keyword"
            },
            "viaf":{
              "type":"keyword"
            }
          }
        },
        "doi": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "hasDoi": {
          "type": "boolean"
        },
        "idHal": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "idProdinra": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "halAuthorId": {
          "type":"keyword"
        },
        "orcId": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "researcherId": {
          "type":"keyword"
        },
        "viaf": {
          "type":"keyword"
        },
        "arxiv": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "pmId": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "nnt": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "patentNumber": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "ut": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "issn": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "eissn": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "xissn": {
          "type":"keyword",
          "normalizer":"id:normalizer"
        },
        "isbn": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "isni": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "ppn":{
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "articleNumber": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "bibCode": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "eisbn": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "ensam": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "ineris": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "inspire": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "ird": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "irstea": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "localRef": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "oatao": {
         "type":"text",
         "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "okina": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "otherNumber": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "pmc": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "sciencespo": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "reportNumber": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "cern": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer"
            }
          }
        },
        "issue": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"issue:normalizer"
            }
          }
        },
        "specialIssue": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"issue:normalizer"
            }
          }
        },
        "meetAbstrNo":{
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"id:normalizer" 
           }
          }
        },
        "pageRange": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"volpage:normalizer"
            }
          }
        },
        "source": {
          "type": "keyword"
        },
        "title": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer"
            },
            "normalized50":{
              "type":"text",
              "analyzer":"analyzer:trunc50"
            }
          },
          "copy_to":"fingerprint"
        },
        "titlefr": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer"
            },
            "normalized50":{
              "type":"text",
              "analyzer":"analyzer:trunc50"
            }
          },
          "copy_to":"fingerprint"
        },
        "titleen": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer"
            },
            "normalized50":{
              "type":"text",
              "analyzer":"analyzer:trunc50"
            }
          },
          "copy_to":"fingerprint"
        },
        "meetingTitle":{
          "type":"text",
          "fields": {
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer" 
           }
          },
          "copy_to":"fingerprint"
        },
        "volume": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"volpage:normalizer"
            }
          }
        },
        "part":{
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"volpage:normalizer"
            }
          }
        },
        "supplement":{
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"volpage:normalizer"
            }
          }
        },
        "typeDocument": {
          "type":"keyword"
        },
        "typeConditor":{
          "type":"text",
          "index":true,
          "fields":{
            "normalized":{
              "type":"keyword"
            }
          }
        },
        "isDuplicate": {
          "type": "boolean"
        },
        "isDeduplicable":{
          "type":"boolean"
        },
        "hasTransDuplicate":{
          "type":"boolean"
        },
        "duplicate":{
          "type":"nested",
          "properties":{
            "idConditor":{
              "type":"keyword"
            },
            "rules":{
              "type":"text"
            },
            "sessionName":{
              "type":"keyword"
            },
            "source":{
              "type":"keyword"
            }
          }
        },
        "duplicateRules":{
          "type":"keyword"
        },
        "idDuplicate":{
          "type":"nested"
        },
        "idChain":{
          "type":"keyword"
        },
        "titreSourceM": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer"
            }
          },
          "copy_to":"fingerprint"
        },
        "titreSourceJ": {
          "type":"text",
          "fields":{
            "normalized":{
              "type":"keyword",
              "normalizer":"title:normalizer"
            }
          },
          "copy_to":"fingerprint"
        },
        "abstract":{
          "type":"text",
          "copy_to":"fingerprint"
        },
        "publicationDate": {
          "type":"text",
          "fields":{
            "date":{
              "type":"date",
              "format": "yyy-MM-dd HH:mm:ss||yyy-MM-dd||yyy-MM||yyyy",
              "ignore_malformed": true
            },
            "normalized":{
              "type":"keyword",
              "normalizer":"publicationDate:normalizer"
            }
          }
        },
        "nearDuplicate":{
          "type":"nested",
          "properties":{
            "idConditor":{
              "type":"keyword"
            },
            "duplicateBySymmetry":{
              "type":"boolean"
            },
            "score":{
              "type":"float"
            },
            "source":{
              "type":"keyword"
            },
            "type": {
              "type":"text"
            }
          }
        },
        "isNearDuplicate":{
          "type":"boolean"
        },
        "creationDate":{
          "type":"date",
          "format": "yyy-MM-dd HH:mm:ss||yyy-MM-dd||epoch_millis"
        }
      }
    }
  }
}


    
